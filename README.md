# –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è DevOps
# üéØ –¶–µ–ª—å

–û—Ü–µ–Ω–∏—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –≤—ã—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª CI/CD, –≤–∫–ª—é—á–∞—è:
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–±–æ—Ä–∫—É –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ,
- –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—é,
- –¥–µ–ø–ª–æ–π,
- –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ,
- —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é rollback-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π.

# Sausage Store

![image](https://user-images.githubusercontent.com/9394918/121517767-69db8a80-c9f8-11eb-835a-e98ca07fd995.png)


## Technologies used

* Frontend ‚Äì TypeScript, Angular.
* Backend  ‚Äì Java 16, Spring Boot, Spring Data.
* Database ‚Äì H2.

## Installation guide
### Backend

Install Java 16 and maven and run:

```bash
cd backend
mvn package
cd target
java -jar sausage-store-0.0.1-SNAPSHOT.jar
```

### Frontend

Install NodeJS and npm on your computer and run:

```bash
cd frontend
npm install
npm run build
npm install -g http-server
sudo http-server ./dist/frontend/ -p 80 --proxy http://localhost:8080
```

Then open your browser and go to [http://localhost](http://localhost)

# ‚úÖ –ó–∞–¥–∞—á–∏

## 1. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
	‚Ä¢	–°–æ–∑–¥–∞—Ç—å Dockerfile –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏ –±—ç–∫–µ–Ω–¥–∞.
	‚Ä¢	–ù–∞—Å—Ç—Ä–æ–∏—Ç—å docker-compose.yml –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.
	‚Ä¢	–û–±–µ—Å–ø–µ—á–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.

## 2. CI
	‚Ä¢	–ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI-–ø–∞–π–ø–ª–∞–π–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, GitHub Actions), –∫–æ—Ç–æ—Ä—ã–π:
	‚Ä¢	—Å–æ–±–∏—Ä–∞–µ—Ç –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ –±—ç–∫–µ–Ω–¥,

## 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
	‚Ä¢	–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Prometheus –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ —Å –±—ç–∫–µ–Ω–¥–∞.
	‚Ä¢	–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç—Ä–∏–∫.
	‚Ä¢	–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º ELK-—Å—Ç–µ–∫–∞ –∏–ª–∏ Loki).

## 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
	‚Ä¢	–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å README.md —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ:
	‚Ä¢	—Å–±–æ—Ä–∫–µ –∏ –∑–∞–ø—É—Å–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è,
	‚Ä¢	—Ä–∞–±–æ—Ç–µ CI –ø–∞–π–ø–ª–∞–π–Ω–∞,
	‚Ä¢	–Ω–∞—Å—Ç—Ä–æ–π–∫–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è,
# üì¨ –§–æ—Ä–º–∞—Ç —Å–¥–∞—á–∏
–ü—É–±–ª–∏—á–Ω—ã–π GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ (–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å fork –æ—Ç —ç—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è).

## –†–µ–∑—É–ª—å—Ç–∞—Ç
–°–æ–∑–¥–∞–ª Dockerfile –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏ –±—ç–∫–µ–Ω–¥–∞, docker-compose –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –°–æ–±—Ä–∞–ª CI –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è —Ç–µ—Å—Ç–æ–≤, –≤–∫–ª—é—á–∏–ª –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ *spec.ts –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞. –ù–∞—Å—Ç—Ä–æ–∏–ª Prometheus, Grafana, Loki –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

Grafana: http://localhost:3000/ log/pass: admin/admin
Prometheus: http://localhost:9090, –º–µ—Ç—Ä–∏–∫–∏ - http://localhost:8080/actuator/prometheus, —Ç–∞—Ä–≥–µ—Ç—ã - http://localhost:9090/targets

–î–ª—è –ø—Ä–æ—Å–º—Ç—Ä–∞ –º–µ—Ç—Ä–∏–∫ —Å Prometheus [Home -> Dashboards](http://localhost:3000/dashboards)
–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –º–µ—Ç—Ä–∏–∫ —Å Loki http://localhost:3000/, –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ Code –∏ –≤—ã–±–∏—Ä–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –Ω–∞–ø—Ä–∏–º–µ—Ä {container="backend"}, –∂–º–µ–º "Run Query"

## –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
git clone git@github.com:manukhov/Test_service.git
cd Test_service
docker plugin install grafana/loki-docker-driver:latest --alias loki --grant-all-permissions
docker compose up --build
```
#  CI Pipeline 

###  Backend
1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Ubuntu (`ubuntu-latest`) –∫–∞–∫ —Å—Ä–µ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
3. –ö–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π 
4. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç JDK 17
5. –°–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ Maven
6. –ó–∞–ø—É—Å–∫–∞–µ—Ç —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã
   
### Frontend
1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Ubuntu –∫–∞–∫ —Å—Ä–µ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
2. –ö–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Node.js 16
4. –ß–∏—Å—Ç–∏—Ç npm-–∫—ç—à
5. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Google Chrome
6. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–µ—Ä—Å–∏—é Chrome
7. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `npm ci`
8. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Protractor –≥–ª–æ–±–∞–ª—å–Ω–æ
9. –°–∫–∞—á–∏–≤–∞–µ—Ç –Ω—É–∂–Ω—É—é –≤–µ—Ä—Å–∏—é ChromeDriver –∏ –∫–ª–∞–¥—ë—Ç –≤ `webdriver-manager`
10. –°–æ–∑–¥–∞—ë—Ç `update-config.json`, —á—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å –Ω—É–∂–Ω—ã–π –ø—É—Ç—å –∫ ChromeDriver
11. –õ–æ–≥–∏—Ä—É–µ—Ç –≤–µ—Ä—Å–∏—é Chrome, ChromeDriver –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É
12. –ò—â–µ—Ç –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ `*.spec.ts` –∏ `*.e2e-spec.ts`
13. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–µ—Ä—Å–∏–∏ Karma, Angular CLI, Protractor
14. –°–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç: `npx ng build`
15. –ó–∞–ø—É—Å–∫–∞–µ—Ç —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ Karma + ChromeHeadless
16. –£–±–∏–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –≤–∏—Å–∏—Ç –Ω–∞ –ø–æ—Ä—Ç–∞—Ö `7860`, `8080`, —Ç.–∫. –ø–æ—Ä—Ç—ã –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∑–∞–Ω—è—Ç—ã
17. –ó–∞–ø—É—Å–∫–∞–µ—Ç backend
18. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω
19. –ó–∞–ø—É—Å–∫–∞–µ—Ç `ng serve` –Ω–∞ 7860 –ø–æ—Ä—Ç—É
20. –ñ–¥—ë—Ç 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—É—Å–∫ —Ñ—Ä–æ–Ω—Ç–∞
21. –ó–∞–ø—É—Å–∫–∞–µ—Ç E2E —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ Protractor (–±–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è WebDriver)
22. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤, –ª–æ–≥–∏—Ä—É–µ—Ç coverage
23. –ó–∞–≥—Ä—É–∂–∞–µ—Ç coverage-–æ—Ç—á—ë—Ç

### P.S. Chrome-Driver –ø—Ä–∏—à–ª–æ—Å—å –∫–∞—á–∞—Ç—å –∏ —Å—Ç–∞–≤–∏—Ç—å —Ä—É–∫–∞–º–∏, –ø–æ—Ç–æ–º—É-—á—Ç–æ webdriver-manager —Å—Ç–∞–≤–∏–ª —Å—Ç–∞—Ä—ã–π –∏ E2E —Ç–µ—Å—Ç—ã –∑–∞–ø–∞—Ä—ã–≤–∞–ª–∏—Å—å, —Ç—Ä–µ–±—É—è –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é.
